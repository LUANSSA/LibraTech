{% extends "core/base.html" %}

{% block titulo_da_pagina %}
Acervo - Itens
{% endblock %}

{% block conteudo %}
{% with request.GET.search as querystring %}

<!-- ======= T√≠tulo e Pesquisa ======= -->
<div class="text-center mb-4">
    <h1 class="mb-3">üîç Pesquise</br> Livros, Peri√≥dicos e Revistas</h1>
    <h1 class="text-center mb-4">
    üîç Pesquise<br>
    üìö Livros, üì∞ Peri√≥dicos, üóûÔ∏è Revistas
    </h1>
    
    <h1 class="text-center mb-4" style="background: linear-gradient(90deg, #0d6efd, #fd7e14, #6f42c1); -webkit-background-clip: text; color: transparent;">
    üîç Pesquise Livros, Peri√≥dicos e Revistas
</h1>
<h1 class="text-center mb-4">
    üîç Pesquise<br>
    <span style="text-decoration: underline; text-decoration-color:#0d6efd;">Livros</span>, 
    <span style="text-decoration: underline; text-decoration-color:#fd7e14;">Peri√≥dicos</span> e 
    <span style="text-decoration: underline; text-decoration-color:#6f42c1;">Revistas</span>
</h1>



    <form class="d-flex justify-content-center" role="search">
        <input class="form-control me-2 w-50" type="search" name="search" value="{{ querystring }}" placeholder="Digite sua busca..." aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Buscar</button>
    </form>
</div>

<!-- ======= LISTAGEM DESKTOP (Tabela) ======= -->
{% if querystring %}
<div class="d-none d-md-block">
    <table class="table table-hover align-middle">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">T√≠tulo</th>
                <th scope="col">N√∫mero</th>
                <th scope="col">√Årea do Acervo</th>
                <th scope="col">Tipo</th>
                {% if user.is_authenticated %}
                    <th scope="col">A√ß√µes</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for item in itens %}
            <tr>
                <th scope="row">{{ item.id }}</th>

                {% comment %} Livros {% endcomment %}
                <td>
                    {% if item.tipo == "Livro" %}
                        <a href="{% url 'livros_detalhe' item.id %}">{{ item.titulo }}</a>
                    {% elif item.tipo == "Peri√≥dico" %}
                        <a href="{% url 'periodicos_detalhe' item.id %}">{{ item.titulo }}</a>
                    {% else %}
                        <a href="{% url 'revistas_detalhe' item.id %}">{{ item.titulo }}</a>
                    {% endif %}
                </td>

                {% comment %} Livros {% endcomment %}
                <td>
                    {% if item.tipo == "Livro" %}
                         <a href="{% url 'livros_detalhe' item.id %}">{{ item.num_tombamento }}</a>
                    {% elif item.tipo == "Peri√≥dico" %}
                        <a href="{% url 'periodicos_detalhe' item.id %}">{{ item.numero }}</a>
                    {% else %}
                        <a href="{% url 'revistas_detalhe' item.id %}">{{ item.numero }}</a>
                    {% endif %}
                </td>

                {% comment %} √Årea do acervo {% endcomment %}
                <td>
                    {% if item.tipo == "Livro" %}
                         <a href="{% url 'livros_detalhe' item.id %}">{{ item.area_acervo }}</a>
                    {% elif item.tipo == "Peri√≥dico" %}
                        <a href="{% url 'periodicos_detalhe' item.id %}">{{ item.area_acervo }}</a>
                    {% else %}
                        <a href="{% url 'revistas_detalhe' item.id %}">{{ item.area_acervo }}</a>
                    {% endif %}
                </td>

                 {% comment %} Tipo {% endcomment %}
                <td>
                    {% if item.tipo == "Livro" %}
                         <a href="{% url 'livros_detalhe' item.id %}">{{ item.tipo }}</a>
                    {% elif item.tipo == "Peri√≥dico" %}
                        <a href="{% url 'periodicos_detalhe' item.id %}">{{ item.tipo }}</a>
                    {% else %}
                        <a href="{% url 'revistas_detalhe' item.id %}">{{ item.tipo }}</a>
                    {% endif %}
                </td>

                {% if user.is_authenticated %}
                <td>
                    {% if item.tipo == "Livro" %}
                        <a href="{% url 'livros_alterar' item.id %}" class="btn btn-success btn-sm">Editar</a>
                        <a href="{% url 'livros_excluir' item.id %}" class="btn btn-danger btn-sm">Excluir</a>
                    {% elif item.tipo == "Peri√≥dico" %}
                        <a href="{% url 'periodicos_alterar' item.id %}" class="btn btn-success btn-sm">Editar</a>
                        <a href="{% url 'periodicos_excluir' item.id %}" class="btn btn-danger btn-sm">Excluir</a>
                    {% else %}
                        <a href="{% url 'revistas_alterar' item.id %}" class="btn btn-success btn-sm">Editar</a>
                        <a href="{% url 'revistas_excluir' item.id %}" class="btn btn-danger btn-sm">Excluir</a>
                    {% endif %}
                </td>
                {% endif %}
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">Nenhum item encontrado.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- ======= LISTAGEM MOBILE (Cards) ======= -->
{% if querystring %}
<div class="d-md-none">
    <div class="row gy-3">
        {% for item in itens %}
        <div class="col-12">
            <div class="card border-dark shadow-sm">
                <div class="card-body p-3">
                    <h5 class="card-title mb-2">
                        {% if item.tipo == "Livro" %}
                            <a href="{% url 'livros_detalhe' item.id %}" class="text-decoration-none fw-bold">{{ item.titulo }}</a>
                        {% elif item.tipo == "Peri√≥dico" %}
                            <a href="{% url 'periodicos_detalhe' item.id %}" class="text-decoration-none fw-bold">{{ item.titulo }}</a>
                        {% else %}
                            <a href="{% url 'revistas_detalhe' item.id %}" class="text-decoration-none fw-bold">{{ item.titulo }}</a>
                        {% endif %}
                    </h5>
                    <p class="mb-1"><strong>N√∫mero:</strong>
                        {% if item.tipo == "Livro" %}
                            {{ item.num_tombamento }}
                        {% else %}
                            {{ item.numero }}
                        {% endif %}
                    </p>
                    <p class="mb-1"><strong>√Årea:</strong> {{ item.area_acervo }}</p>
                    <p class="mb-2"><strong>Tipo:</strong> {{ item.tipo }}</p>

                    {% if user.is_authenticated %}
                    <div class="d-flex justify-content-end gap-2">
                        {% if item.tipo == "Livro" %}
                            <a href="{% url 'livros_alterar' item.id %}" class="btn btn-success btn-sm">Editar</a>
                            <a href="{% url 'livros_excluir' item.id %}" class="btn btn-danger btn-sm">Excluir</a>
                        {% elif item.tipo == "Peri√≥dico" %}
                            <a href="{% url 'periodicos_alterar' item.id %}" class="btn btn-success btn-sm">Editar</a>
                            <a href="{% url 'periodicos_excluir' item.id %}" class="btn btn-danger btn-sm">Excluir</a>
                        {% else %}
                            <a href="{% url 'revistas_alterar' item.id %}" class="btn btn-success btn-sm">Editar</a>
                            <a href="{% url 'revistas_excluir' item.id %}" class="btn btn-danger btn-sm">Excluir</a>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center mt-4">Nenhum item encontrado.</p>
        {% endfor %}
    </div>
</div>
{% endif %}

{% endwith %}
{% endblock conteudo %}
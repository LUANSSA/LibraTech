{% extends "core/base.html" %}

{% block titulo_da_pagina %}
Acervo
{% endblock titulo_da_pagina %}

{% block conteudo %}

{% comment %} Título e Pesquisa {% endcomment %}
<div class="search-section d-flex align-items-center justify-content-center text-center">
    <div class="search-container">
        <h1 class="mb-4">🔍 Pesquise Livros, Revistas e Periódicos</h1>
        <form class="d-flex justify-content-center gap-2" role="search" method="get" action="">
            <input class="form-control" type="search" name="search" value="{{ request.GET.search }}" placeholder="Buscar..." aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Buscar</button>
        </form>
    </div>
</div>

{% comment %} Exibir Tabela Somente Após Pesquisa {% endcomment %}
{% if request.GET.search %}
    <div class="container mt-4">
        {% comment %} Tabela Combinada de Livros, Revistas e Periódicos {% endcomment %}
        <h2 class="mb-4">📚 Resultados de Pesquisa</h2>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Título</th>
                    <th scope="col">Tipo</th>
                    <th scope="col">Ação</th>
                </tr>
            </thead>
            <tbody>
                {% comment %} Livros {% endcomment %}
                {% for livro in livros %}
                    <tr>
                        <th scope="row"><a href="{% url 'livros_detalhe' livro.id %}">{{ livro.id }}</a></th>
                        <td><a href="{% url 'livros_detalhe' livro.id %}">{{ livro.titulo }}</a></td>
                        <td>Livro</td>
                        <td><a href="{% url 'livros_detalhe' livro.id %}" class="btn btn-primary btn-sm">Detalhes</a></td>
                    </tr>
                {% empty %}
                    <tr><td colspan="4" class="text-center">Nenhum livro encontrado.</td></tr>
                {% endfor %}
                
                {% comment %} Revistas {% endcomment %}
                {% for revista in revistas %}
                    <tr>
                        <th scope="row"><a href="{% url 'revistas_detalhe' revista.id %}">{{ revista.id }}</a></th>
                        <td><a href="{% url 'revistas_detalhe' revista.id %}">{{ revista.titulo }}</a></td>
                        <td>Revista</td>
                        <td><a href="{% url 'revistas_detalhe' revista.id %}" class="btn btn-primary btn-sm">Detalhes</a></td>
                    </tr>
                {% empty %}
                    <tr><td colspan="4" class="text-center">Nenhuma revista encontrada.</td></tr>
                {% endfor %}

                {% comment %} Periódicos {% endcomment %}
                {% for periodico in periodicos %}
                    <tr>
                        <th scope="row"><a href="{% url 'periodicos_detalhe' periodico.id %}">{{ periodico.id }}</a></th>
                        <td><a href="{% url 'periodicos_detalhe' periodico.id %}">{{ periodico.titulo }}</a></td>
                        <td>Periódico</td>
                        <td><a href="{% url 'periodicos_detalhe' periodico.id %}" class="btn btn-primary btn-sm">Detalhes</a></td>
                    </tr>
                {% empty %}
                    <tr><td colspan="4" class="text-center">Nenhum periódico encontrado.</td></tr>
                {% endfor %}
            </tbody>
        </table>

        {% comment %} Paginação {% endcomment %}
        {% include "core/paginacao.html" %}
    </div>
{% endif %}

{% endblock conteudo %}
